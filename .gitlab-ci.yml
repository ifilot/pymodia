image: debian:stable

pypi-compilation:
  image: python:3.11-slim-bullseye
  script:
    - pip install build
    - python -m build
  artifacts:
    paths:
      - dist/pymodia-*.whl

documentation:
  image: ghcr.io/ifilot/sphinx:v0.4.0 # custom Sphinx image
  script:
    - pushd docs && make html && popd
  artifacts:
    paths:
      - docs/_build/html
    expire_in: 1 hour

pages:
  needs: ["documentation"]
  only:
    refs:
      - master
  script:
    - cp -rv docs/_build/html/ public
  dependencies:
    - documentation
  artifacts:
    paths:
      - public